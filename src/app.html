<!doctype html>
<html lang="en" class="dark">
	<head>
		<meta charset="utf-8" />
		<meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; connect-src 'self' https://*.supabase.co wss://*.supabase.co; font-src 'self';" />
		<link rel="icon" href="%sveltekit.assets%/favicon.svg" type="image/svg+xml" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta name="theme-color" content="#0F0E0C" />
		<meta name="description" content="Navigate Wikipedia to reach Basil the Great in as few clicks as possible" />
		<link rel="manifest" href="%sveltekit.assets%/manifest.json" />
		<link rel="apple-touch-icon" href="%sveltekit.assets%/icons/icon-192.svg" />
		<title>Via Basilica</title>
		<script>
			// Early error handler to catch any uncaught errors
			window.addEventListener('error', function(e) {
				console.error('[GLOBAL ERROR]', e.message, 'at', e.filename + ':' + e.lineno);
			});
			window.addEventListener('unhandledrejection', function(e) {
				console.error('[UNHANDLED PROMISE REJECTION]', e.reason);
			});
			console.log('[App] Early script loaded');

			(function() {
				var theme = localStorage.getItem('via_basilica_theme');
				var prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
				var isDark = theme ? theme === 'dark' : prefersDark;
				document.documentElement.classList.toggle('dark', isDark);
				document.documentElement.classList.toggle('light', !isDark);
				console.log('[App] Theme initialized:', isDark ? 'dark' : 'light');
			})();
		</script>
		%sveltekit.head%
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents">%sveltekit.body%</div>
	</body>
</html>
